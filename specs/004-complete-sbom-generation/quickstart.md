# SBOMç”Ÿæˆ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€wtãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®SBOMï¼ˆSoftware Bill of Materialsï¼‰ç”Ÿæˆæ©Ÿèƒ½ã®ä½¿ç”¨æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã‚¬ã‚¤ãƒ‰](#ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã‚¬ã‚¤ãƒ‰)
3. [é–‹ç™ºè€…å‘ã‘ã‚¬ã‚¤ãƒ‰](#é–‹ç™ºè€…å‘ã‘ã‚¬ã‚¤ãƒ‰)
4. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## æ¦‚è¦

### SBOMã¨ã¯ï¼Ÿ

SBOMï¼ˆSoftware Bill of Materialsï¼‰ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã€Œéƒ¨å“è¡¨ã€ã§ã™ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä½¿ç”¨ã—ã¦ã„ã‚‹ã™ã¹ã¦ã®ä¾å­˜é–¢ä¿‚ï¼ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰ã‚’ä¸€è¦§åŒ–ã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã€ä»¥ä¸‹ã®ç›®çš„ã§ä½¿ç”¨ã•ã‚Œã¾ã™ï¼š

- **ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³ã®é€æ˜æ€§**: ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«å«ã¾ã‚Œã‚‹å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ˜ç¤º
- **è„†å¼±æ€§ç®¡ç†**: ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ã‚’è¿½è·¡ãƒ»ä¿®æ­£
- **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹**: ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’ç¢ºèª
- **ç›£æŸ»è¨¼è·¡**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚„ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯ã«åˆ©ç”¨

### wtãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®SBOM

wtãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å„ãƒªãƒªãƒ¼ã‚¹ã«å¯¾ã—ã¦ä»¥ä¸‹ã‚’æä¾›ã—ã¾ã™ï¼š

âœ… **SPDX 2.3å½¢å¼ã®SBOM** - ISO/IEC 5962:2021æº–æ‹   
âœ… **GitHubä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•çµ±åˆ** - Dependabot/Renovateã‚¢ãƒ©ãƒ¼ãƒˆè‡ªå‹•æœ‰åŠ¹åŒ–  
âœ… **ãƒªãƒªãƒ¼ã‚¹ã‚¢ã‚»ãƒƒãƒˆæ·»ä»˜** - èª°ã§ã‚‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½

---

## ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã‚¬ã‚¤ãƒ‰

### SBOMã®å–å¾—æ–¹æ³•

#### æ–¹æ³•1: GitHubãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰

1. [wtã®ãƒªãƒªãƒ¼ã‚¹ãƒšãƒ¼ã‚¸](https://github.com/kuju63/wt/releases)ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠï¼ˆä¾‹: v1.0.0ï¼‰
3. **Assets** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ `wt-v1.0.0-sbom.spdx.json` ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```bash
# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆLinux/macOSï¼‰
curl -L https://github.com/kuju63/wt/releases/download/v1.0.0/wt-v1.0.0-sbom.spdx.json \
  -o wt-sbom.spdx.json
```

#### æ–¹æ³•2: GitHubä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•ã‹ã‚‰ç¢ºèª

1. [wtãƒªãƒã‚¸ãƒˆãƒª](https://github.com/kuju63/wt)ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **Insights** ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
3. **Dependency graph** ã‚’é¸æŠ
4. ã™ã¹ã¦ã®ä¾å­˜é–¢ä¿‚ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèª

### SBOMã®æ¤œè¨¼

SBOMãŒæ­£ã—ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹æ¤œè¨¼ã™ã‚‹æ–¹æ³•ï¼š

```bash
# jqã‚’ä½¿ç”¨ã—ãŸã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ¤œè¨¼ï¼ˆæ¨å¥¨ï¼‰
SBOM_FILE="wt-sbom.spdx.json"

# å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ¤œè¨¼
jq -e '.spdxVersion, .dataLicense, .name, .documentNamespace, .creationInfo.created, .packages' "$SBOM_FILE" > /dev/null && echo "âœ… SBOM validation passed" || echo "âŒ SBOM validation failed"

# è©³ç´°ãªæ¤œè¨¼çµæœã‚’è¡¨ç¤º
echo "SPDX Version: $(jq -r '.spdxVersion' "$SBOM_FILE")"
echo "Data License: $(jq -r '.dataLicense' "$SBOM_FILE")"
echo "Document Name: $(jq -r '.name' "$SBOM_FILE")"
echo "Package Count: $(jq '.packages | length' "$SBOM_FILE")"
```

æˆåŠŸæ™‚ã®å‡ºåŠ›ï¼š

```text
âœ… SBOM validation passed
SPDX Version: SPDX-2.2
Data License: CC0-1.0
Document Name: kuju63/wt v1.0.0
Package Count: 7
```

### SBOMã®å†…å®¹ã‚’ç¢ºèª

#### ä¾å­˜é–¢ä¿‚ã®ä¸€è¦§è¡¨ç¤º

```bash
# jqã‚’ä½¿ç”¨ã—ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŠ½å‡º
jq -r '.packages[] | "\(.name)@\(.versionInfo)"' wt-sbom.spdx.json
```

å‡ºåŠ›ä¾‹ï¼š

```text
System.CommandLine@2.0.1
System.IO.Abstractions@22.1.0
System.Memory@4.5.5
...
```

#### ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æƒ…å ±ã®ç¢ºèª

```bash
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¡¨ç¤º
jq -r '.packages[] | "\(.name): \(.licenseDeclared)"' wt-sbom.spdx.json
```

å‡ºåŠ›ä¾‹ï¼š

```text
System.CommandLine: MIT
System.IO.Abstractions: MIT
System.Memory: MIT
...
```

### è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯

#### æ–¹æ³•1: GitHub Dependabotï¼ˆè‡ªå‹•ï¼‰

wtãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯è‡ªå‹•çš„ã«DependabotãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ãŠã‚Šã€è„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚Œã‚‹ã¨ï¼š

1. ãƒªãƒã‚¸ãƒˆãƒªã® **Security** ã‚¿ãƒ–ã«ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º
2. ãƒ¡ãƒ³ãƒ†ãƒŠã«è‡ªå‹•é€šçŸ¥
3. å¯èƒ½ã§ã‚ã‚Œã°è‡ªå‹•ä¿®æ­£PRãŒä½œæˆã•ã‚Œã‚‹

#### æ–¹æ³•2: ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ã‚¹ã‚­ãƒ£ãƒ³

```bash
# OSV Scannerã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
osv-scanner --sbom=wt-sbom.spdx.json

# Grypeã‚’ä½¿ç”¨
grype sbom:wt-sbom.spdx.json
```

### ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå‘ã‘: SBOMçµ±åˆ

#### 1. Dependency-Trackã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```bash
# Dependency-Track APIã‚’ä½¿ç”¨
curl -X POST "https://your-dependency-track.com/api/v1/bom" \
  -H "X-Api-Key: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d @wt-sbom.spdx.json
```

#### 2. ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯

```bash
# SPDX Toolsã‚’ä½¿ç”¨ã—ã¦ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã‚’ç¢ºèª
spdx-tools verify wt-sbom.spdx.json
```

---

## é–‹ç™ºè€…å‘ã‘ã‚¬ã‚¤ãƒ‰

### ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®SBOMç”Ÿæˆ

é–‹ç™ºä¸­ã«ãƒ­ãƒ¼ã‚«ãƒ«ã§SBOMã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ï¼š

#### 1. Microsoft SBOM Toolã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
dotnet tool install --global Microsoft.Sbom.DotNetTool
```

#### 2. ä¾å­˜é–¢ä¿‚ã®ãƒªã‚¹ãƒˆã‚¢

```bash
cd /path/to/wt
dotnet restore --locked-mode
```

#### 3. SBOMç”Ÿæˆ

```bash
sbom-tool generate \
  -b ./sbom-output \
  -bc . \
  -pn kuju63/wt \
  -pv 1.0.0-dev \
  -nsb https://github.com/kuju63/wt/sbom/dev
```

#### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¬æ˜

- `-b`: å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
- `-bc`: ãƒ“ãƒ«ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹
- `-pn`: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å
- `-pv`: ãƒãƒ¼ã‚¸ãƒ§ãƒ³
- `-nsb`: åå‰ç©ºé–“URIï¼ˆä¸€æ„æ€§ä¿è¨¼ï¼‰

ç”Ÿæˆã•ã‚ŒãŸSBOMã¯ `./sbom-output/_manifest/spdx_2.2/manifest.spdx.json` ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

### CI/CDã§ã®å‹•ä½œç¢ºèª

#### PRæ™‚ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆæ¨å¥¨ï¼‰

Pull Requestã‚’ä½œæˆã™ã‚‹ã¨ã€SBOMç”Ÿæˆãƒ†ã‚¹ãƒˆãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™ï¼š

```bash
# ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã¦PRã‚’é–‹ã
git checkout -b feature/add-dependency
git push origin feature/add-dependency
gh pr create --title "Add new dependency"

# ãƒ†ã‚¹ãƒˆçµæœã‚’ç¢ºèª
gh pr checks
```

PRæ™‚ãƒ†ã‚¹ãƒˆã§ç¢ºèªã•ã‚Œã‚‹é …ç›®ï¼š

- âœ… ä¾å­˜é–¢ä¿‚ã®ãƒªã‚¹ãƒˆã‚¢ãŒæˆåŠŸã™ã‚‹ã‹
- âœ… SBOMç”ŸæˆãŒæˆåŠŸã™ã‚‹ã‹
- âœ… SPDX 2.3ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒæ­£ã—ã„ã‹
- âœ… å¿…é ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆSystem.CommandLineç­‰ï¼‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™ï¼ˆ15åˆ†ä»¥å†…ï¼‰ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹

**é‡è¦: PRæ™‚ã®åˆ¶é™äº‹é …**

- âŒ GitHub Dependency Graphã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¯**è¡Œã„ã¾ã›ã‚“**
- âŒ Dependency Submission APIã¯**å‘¼ã³å‡ºã—ã¾ã›ã‚“**
- âœ… SBOMç”Ÿæˆã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¤œè¨¼ã®ã¿å®Ÿè¡Œï¼ˆDry-runãƒ¢ãƒ¼ãƒ‰ï¼‰

ç†ç”±:

- PRæ™‚ã®ä¾å­˜é–¢ä¿‚ã¯ã¾ã ç¢ºå®šã—ã¦ã„ãªã„ï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸­ï¼‰
- mainãƒ–ãƒ©ãƒ³ãƒã®ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•ã‚’æ±šæŸ“ã—ãªã„
- ãƒ†ã‚¹ãƒˆç›®çš„ã®ã¿ï¼ˆãƒªãƒªãƒ¼ã‚¹å‰ã®å“è³ªç¢ºèªï¼‰

ã“ã‚Œã«ã‚ˆã‚Šã€**ãƒªãƒªãƒ¼ã‚¹å‰ã«ä¸å…·åˆã‚’ç™ºè¦‹**ã—ã¤ã¤ã€æœ¬ç•ªç’°å¢ƒã‚’æ±šæŸ“ã—ã¾ã›ã‚“ã€‚

#### PRæ™‚ vs ãƒªãƒªãƒ¼ã‚¹æ™‚ã®æ¯”è¼ƒ

| é …ç›®                     | PRæ™‚ï¼ˆsbom-test.ymlï¼‰ | ãƒªãƒªãƒ¼ã‚¹æ™‚ï¼ˆrelease.ymlï¼‰ |
| ------------------------ | --------------------- | ------------------------- |
| **ä¾å­˜é–¢ä¿‚ãƒªã‚¹ãƒˆã‚¢**     | âœ… å®Ÿè¡Œ               | âœ… å®Ÿè¡Œ                   |
| **SBOMç”Ÿæˆ**             | âœ… å®Ÿè¡Œ               | âœ… å®Ÿè¡Œ                   |
| **SPDXæ¤œè¨¼**             | âœ… å®Ÿè¡Œ               | âœ… å®Ÿè¡Œ                   |
| **Dependency Graphé€ä¿¡** | âŒ **é€ä¿¡ã—ãªã„**     | âœ… **é€ä¿¡ã™ã‚‹**           |
| **ãƒªãƒªãƒ¼ã‚¹ã‚¢ã‚»ãƒƒãƒˆæ·»ä»˜** | âŒ ãªã—               | âœ… æ·»ä»˜ã™ã‚‹               |
| **Dependabotã‚¢ãƒ©ãƒ¼ãƒˆ**   | âŒ æ›´æ–°ãªã—           | âœ… è‡ªå‹•æœ‰åŠ¹åŒ–             |
| **ç›®çš„**                 | ãƒ†ã‚¹ãƒˆãƒ»å“è³ªç¢ºèª      | æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤              |
| **å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°**       | PRä½œæˆãƒ»æ›´æ–°æ™‚        | mainã¸ã®ãƒãƒ¼ã‚¸æ™‚          |

**ãƒã‚¤ãƒ³ãƒˆ**: PRæ™‚ã¯ã€ŒSBOMç”ŸæˆãŒæˆåŠŸã™ã‚‹ã‹ã€ã®ã¿ã‚’ãƒ†ã‚¹ãƒˆã—ã€å®Ÿéš›ã®GitHubçµ±åˆï¼ˆDependency Graphã€Dependabotï¼‰ã¯ãƒªãƒªãƒ¼ã‚¹æ™‚ã®ã¿å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

#### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æ‰‹å‹•å®Ÿè¡Œ

```bash
# ãƒªãƒªãƒ¼ã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼
gh workflow run release.yml \
  --ref feature/your-branch

# SBOM ãƒ†ã‚¹ãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ‰‹å‹•å®Ÿè¡Œ
gh workflow run sbom-test.yml \
  --ref feature/your-branch

# å®Ÿè¡ŒçŠ¶æ³ã®ç¢ºèª
gh run list --workflow=release.yml --limit 1
gh run list --workflow=sbom-test.yml --limit 1
```

#### ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ¤œè¨¼

```bash
# act ã‚’ä½¿ç”¨ã—ã¦GitHub Actionsã‚’ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œ
act release --secret GITHUB_TOKEN=your_token
```

### SBOMç”Ÿæˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

#### ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰ã®ä¾å­˜é–¢ä¿‚ã‚’å«ã‚ã‚‹

```bash
# ç‰¹å®šã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ IDã§ç”Ÿæˆ
dotnet restore --locked-mode -r win-x64
sbom-tool generate -b ./sbom-output -bc . -pn kuju63/wt -pv 1.0.0 -nsb https://github.com/kuju63/wt/sbom/1.0.0
```

#### è¿½åŠ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ä»˜ä¸

```bash
# ç’°å¢ƒå¤‰æ•°ã§è¿½åŠ æƒ…å ±ã‚’è¨­å®š
export SBOM_BUILD_ID="12345"
export SBOM_BUILD_URL="https://github.com/kuju63/wt/actions/runs/12345"

sbom-tool generate \
  -b ./sbom-output \
  -bc . \
  -pn kuju63/wt \
  -pv 1.0.0 \
  -nsb https://github.com/kuju63/wt/sbom/1.0.0 \
  -m build_id=$SBOM_BUILD_ID \
  -m build_url=$SBOM_BUILD_URL
```

### æ–°ã—ã„ä¾å­˜é–¢ä¿‚ã®è¿½åŠ æ™‚

æ–°ã—ã„NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹éš›ã®æ‰‹é †ï¼š

1. **ä¾å­˜é–¢ä¿‚ã‚’è¿½åŠ **

   ```bash
   dotnet add wt.cli/wt.cli.csproj package NewPackage
   ```

2. **ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°**

   ```bash
   dotnet restore --locked-mode
   ```

3. **SBOMç”Ÿæˆã‚’ãƒ†ã‚¹ãƒˆ**

   ```bash
   sbom-tool generate -b ./test-sbom -bc . -pn kuju63/wt -pv test -nsb https://github.com/kuju63/wt/sbom/test
   jq '.packages[] | select(.name=="NewPackage")' ./test-sbom/_manifest/spdx_2.2/manifest.spdx.json
   ```

4. **ãƒªãƒªãƒ¼ã‚¹æ™‚ã«è‡ªå‹•åæ˜ **: ãƒªãƒªãƒ¼ã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒè‡ªå‹•çš„ã«æ–°ã—ã„ä¾å­˜é–¢ä¿‚ã‚’å«ã‚€SBOMã‚’ç”Ÿæˆ

### GitHub Dependency Submission APIã®ãƒ†ã‚¹ãƒˆ

#### 1. ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™

```bash
# SBOMã‹ã‚‰Dependency Snapshotå½¢å¼ã«å¤‰æ›ï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå¿…è¦ï¼‰
python scripts/spdx-to-snapshot.py \
  --spdx sbom-output/_manifest/spdx_2.2/manifest.spdx.json \
  --output snapshot.json \
  --sha $(git rev-parse HEAD) \
  --ref refs/heads/$(git branch --show-current)
```

#### 2. APIå‘¼ã³å‡ºã—

```bash
# GitHub CLIã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
gh api \
  --method POST \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/kuju63/wt/dependency-graph/snapshots \
  --input snapshot.json

# curlã‚’ä½¿ç”¨
curl -X POST \
  -H "Authorization: Bearer $GITHUB_TOKEN" \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  https://api.github.com/repos/kuju63/wt/dependency-graph/snapshots \
  -d @snapshot.json
```

#### 3. ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•ã®ç¢ºèª

```bash
# GitHub CLIã§ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•ã‚’å–å¾—
gh api /repos/kuju63/wt/dependency-graph/sbom

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª
open "https://github.com/kuju63/wt/network/dependencies"
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### å•é¡Œ1: SBOMç”ŸæˆãŒå¤±æ•—ã™ã‚‹

**ç—‡çŠ¶**:

```text
Error: No packages found in the build directory
```

**åŸå› **: ä¾å­˜é–¢ä¿‚ãŒå¾©å…ƒã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:

```bash
# ä¾å­˜é–¢ä¿‚ã‚’ãƒªã‚¹ãƒˆã‚¢
dotnet restore --locked-mode

# SBOMç”Ÿæˆã‚’å†å®Ÿè¡Œ
sbom-tool generate -b ./sbom-output -bc . -pn kuju63/wt -pv 1.0.0 -nsb https://github.com/kuju63/wt/sbom/1.0.0
```

#### å•é¡Œ2: GitHub APIå‘¼ã³å‡ºã—ãŒ403 Forbiddenã§å¤±æ•—

**ç—‡çŠ¶**:

```text
Error: Resource not accessible by integration
```

**åŸå› **: GITHUB_TOKENã®æ¨©é™ä¸è¶³

**è§£æ±ºæ–¹æ³•**:

```yaml
# .github/workflows/release.ymlã§æ¨©é™ã‚’è¨­å®š
permissions:
  contents: write
  id-token: write
```

#### å•é¡Œ3: SBOMã«ä¸€éƒ¨ã®ä¾å­˜é–¢ä¿‚ãŒå«ã¾ã‚Œã¦ã„ãªã„

**ç—‡çŠ¶**: NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¸€éƒ¨ãŒSBOMã«è¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰ã®ä¾å­˜é–¢ä¿‚ãŒå¾©å…ƒã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:

```bash
# ã™ã¹ã¦ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§å¾©å…ƒ
dotnet restore --locked-mode -r win-x64
dotnet restore --locked-mode -r linux-x64
dotnet restore --locked-mode -r linux-arm
dotnet restore --locked-mode -r osx-arm64

# SBOMç”Ÿæˆ
sbom-tool generate -b ./sbom-output -bc . -pn kuju63/wt -pv 1.0.0 -nsb https://github.com/kuju63/wt/sbom/1.0.0
```

#### å•é¡Œ4: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã™ã‚‹

**ç—‡çŠ¶**: GitHub ActionsãŒ15åˆ†ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**åŸå› **: å¤§è¦æ¨¡ãªä¾å­˜é–¢ä¿‚ãƒ„ãƒªãƒ¼

**è§£æ±ºæ–¹æ³•**:

```yaml
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æœ‰åŠ¹åŒ–
- uses: actions/cache@v4
  with:
    path: ~/.nuget/packages
    key: ${{ runner.os }}-nuget-${{ hashFiles('**/packages.lock.json') }}

# ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’å»¶é•·ï¼ˆæœ€å¤§60åˆ†ï¼‰
timeout-minutes: 30
```

#### å•é¡Œ5: PRæ™‚ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹

**ç—‡çŠ¶**: SBOMç”Ÿæˆãƒ†ã‚¹ãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆsbom-test.ymlï¼‰ãŒPRã§å¤±æ•—

**åŸå› **:

- æ–°ã—ã„ä¾å­˜é–¢ä¿‚ãŒè¿½åŠ ã•ã‚ŒãŸãŒã€packages.lock.jsonãŒæ›´æ–°ã•ã‚Œã¦ã„ãªã„
- å¿…é ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒèª¤ã£ã¦å‰Šé™¤ã•ã‚ŒãŸ
- SBOMãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒç„¡åŠ¹

**è§£æ±ºæ–¹æ³•**:

```bash
# ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°
dotnet restore --locked-mode

# ãƒ­ãƒ¼ã‚«ãƒ«ã§SBOMç”Ÿæˆã‚’ãƒ†ã‚¹ãƒˆ
sbom-tool generate -b ./test-sbom -bc . -pn test -pv test -nsb https://test

# SPDXãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆjqãƒ™ãƒ¼ã‚¹ï¼‰
SBOM_FILE="./test-sbom/_manifest/spdx_2.2/manifest.spdx.json"
jq -e '.spdxVersion, .dataLicense, .name, .documentNamespace, .creationInfo.created, .packages' "$SBOM_FILE" > /dev/null && echo "âœ… Validation passed" || echo "âŒ Validation failed"

# å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
git add wt.cli/packages.lock.json
git commit -m "fix: update packages.lock.json"
git push
```

**ç¢ºèªé …ç›®**:

1. packages.lock.jsonãŒæœ€æ–°ã‹ï¼Ÿ
2. å¿…é ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆSystem.CommandLineã€System.IO.Abstractionsï¼‰ãŒæ®‹ã£ã¦ã„ã‚‹ã‹ï¼Ÿ
3. ãƒ­ãƒ¼ã‚«ãƒ«ã§SBOMç”ŸæˆãŒæˆåŠŸã™ã‚‹ã‹ï¼Ÿ

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

#### è©³ç´°ãƒ­ã‚°ã®æœ‰åŠ¹åŒ–

```bash
# SBOM Toolè©³ç´°ãƒ­ã‚°
sbom-tool generate \
  -b ./sbom-output \
  -bc . \
  -pn kuju63/wt \
  -pv 1.0.0 \
  -nsb https://github.com/kuju63/wt/sbom/1.0.0 \
  -v Diagnostic  # ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«: Diagnostic, Information, Warning, Error
```

```yaml
# GitHub Actionsè©³ç´°ãƒ­ã‚°
- name: Generate SBOM
  run: sbom-tool generate ...
  env:
    ACTIONS_STEP_DEBUG: true
```

#### SBOMå†…å®¹ã®è©³ç´°ç¢ºèª

```bash
# ã™ã¹ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±ã‚’è¡¨ç¤º
jq '.packages[]' wt-sbom.spdx.json

# ç‰¹å®šãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¾å­˜é–¢ä¿‚ã‚’è¡¨ç¤º
jq '.relationships[] | select(.spdxElementId | contains("System.CommandLine"))' wt-sbom.spdx.json

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
jq '{version: .spdxVersion, name: .name, created: .creationInfo.created}' wt-sbom.spdx.json
```

---

## è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [SPDXä»•æ§˜](https://spdx.github.io/spdx-spec/)
- [Microsoft SBOM Tool](https://github.com/microsoft/sbom-tool)
- [GitHub Dependency Submission API](https://docs.github.com/en/rest/dependency-graph/dependency-submission)
- [Package URLä»•æ§˜](https://github.com/package-url/purl-spec)

### ãƒ„ãƒ¼ãƒ«

- [jq](https://stedolan.github.io/jq/) - JSONå‡¦ç†ãƒ„ãƒ¼ãƒ«ï¼ˆSBOMæ¤œè¨¼ã«ä½¿ç”¨ã€æ¨å¥¨ï¼‰
- [OSV Scanner](https://github.com/google/osv-scanner) - è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
- [Grype](https://github.com/anchore/grype) - è„†å¼±æ€§æ¤œå‡º
- [Dependency-Track](https://dependencytrack.org/) - SBOMãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

### ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£

- [Issueå ±å‘Š](https://github.com/kuju63/wt/issues)
- [Discussion](https://github.com/kuju63/wt/discussions)

---

## ã‚µãƒãƒ¼ãƒˆ

è³ªå•ã‚„å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®æ–¹æ³•ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ï¼š

- **GitHub Issues**: <https://github.com/kuju63/wt/issues>
- **GitHub Discussions**: <https://github.com/kuju63/wt/discussions>

---

æœ€çµ‚æ›´æ–°: 2026-01-06
