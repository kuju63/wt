# ADR 0001: Add Clean & Secure Code requirements to Constitution

**Status**: Accepted

**Date**: 2026-01-03

## Context

レビューおよび自動解析ツール（例: SonarC#, Lizard, markdownlint）で検出されるセキュリティ/品質指摘に対して、一貫した運用ルールが必要となった。特に空の catch ブロックや汎用例外の無条件捕捉、外部入力の未検証、秘密情報のハードコード等はセキュリティ・保守性の観点からリスクが高い。

## Decision

`constitution.md` の「III. Clean & Secure Code (クリーンでセキュアなコード)」セクションに、以下の要件を追加する決定を行う。

- 例外の扱い: 空の `catch { }` を禁止し、無視する場合は理由をコメントで明記しログに記録すること。
- 特定例外の捕捉: 汎用的な `Exception` の丸抱え捕捉を避けること。
- 入力検証: 外部入力は常に検証・正規化を行うこと。
- 秘密情報の管理: シークレットマネージャ等の利用を義務化すること。
- 最小権限の原則: 実行コンテキストは最小権限で構成すること。
- 依存関係の脆弱性対応: 重大/高リスクは72時間以内に対応計画を提示すること。
- 重大セキュリティ問題の優先対応: High/Critical はマージ前に解決するか審査で許可を得ること。

これらはガイドラインとし、例外は ADR に理由を記録して承認すること。

## Consequences

- コードレビューと CI における静的解析の重要度が高まるため、レビュープロセスが若干厳格化する。
- 一部既存コードは修正（例: 空の catch へのコメント追加、例外の具体化、入力検証追加）が必要となる。
- 依存関係管理・セキュリティ対応のフロー整備が必要になる（自動スキャン、通知、対応トラッキング）。

## Alternatives Considered

- 何もしない: リスクが残るため却下。
- すべての警告を blocker として強制する: 過剰負荷となるため段階的運用を採用。

## Authors

- Jun Kurihara <lh182051+src@gmail.com>
