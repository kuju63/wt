<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Contract: Test Workflow | wt </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Contract: Test Workflow | wt ">
      
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/kuju63/wt/blob/main/specs/003-automated-release-pipeline/contracts/test-workflow.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" class="svg" src="../../../logo.svg" alt="wt">
            wt
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="contract-test-workflow">Contract: Test Workflow</h1>

<p><strong>Workflow</strong>: <code>.github/workflows/test.yml</code><br>
<strong>Feature</strong>: 003-automated-release-pipeline<br>
<strong>Date</strong>: 2026-01-05</p>
<h2 id="æ¦‚è¦">æ¦‚è¦</h2>
<p>å…¨ãƒ–ãƒ©ãƒ³ãƒã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’Codacyã«å ±å‘Šã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€‚</p>
<hr>
<h2 id="ãƒˆãƒªã‚¬ãƒ¼">ãƒˆãƒªã‚¬ãƒ¼</h2>
<h3 id="push-to-branches">Push to branches</h3>
<pre><code class="lang-yaml">on:
  push:
    branches:
      - main
      - 'feature/**'
      - 'fix/**'
</code></pre>
<p><strong>å‹•ä½œ</strong>: main, feature, fix ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•å®Ÿè¡Œ</p>
<h3 id="pull-request-to-main">Pull request to main</h3>
<pre><code class="lang-yaml">on:
  pull_request:
    branches:
      - main
</code></pre>
<p><strong>å‹•ä½œ</strong>: mainãƒ–ãƒ©ãƒ³ãƒã¸ã®PRã§è‡ªå‹•å®Ÿè¡Œ</p>
<hr>
<h2 id="ã‚¸ãƒ§ãƒ–å®šç¾©">ã‚¸ãƒ§ãƒ–å®šç¾©</h2>
<h3 id="job-test">Job: <code>test</code></h3>
<p><strong>Purpose</strong>: ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’å ±å‘Šã™ã‚‹</p>
<p><strong>Runner</strong>: <code>ubuntu-latest</code></p>
<p><strong>ã‚¹ãƒ†ãƒƒãƒ—</strong>:</p>
<ol>
<li><p><strong>Checkout repository</strong></p>
<ul>
<li>Action: <code>actions/checkout@v4</code></li>
<li>Purpose: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®ãŸã‚ãƒªãƒã‚¸ãƒˆãƒªã‚³ãƒ¼ãƒ‰ã‚’å–å¾—</li>
</ul>
</li>
<li><p><strong>Setup .NET</strong></p>
<ul>
<li>Action: <code>actions/setup-dotnet@v4</code></li>
<li>Version: <code>10.0.x</code></li>
<li>Purpose: .NET SDKã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</li>
</ul>
</li>
<li><p><strong>Restore dependencies</strong></p>
<ul>
<li>Command: <code>dotnet restore wt.sln</code></li>
<li>Purpose: NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å¾©å…ƒ</li>
</ul>
</li>
<li><p><strong>Build solution</strong></p>
<ul>
<li>Command: <code>dotnet build wt.sln --configuration Release --no-restore</code></li>
<li>Purpose: Releaseãƒ¢ãƒ¼ãƒ‰ã§ãƒ“ãƒ«ãƒ‰</li>
</ul>
</li>
<li><p><strong>Run tests with coverage</strong></p>
<ul>
<li><p>Command:</p>
<pre><code class="lang-bash">dotnet test wt.sln \
  --configuration Release \
  --no-build \
  --verbosity normal \
  --collect:&quot;XPlat Code Coverage&quot; \
  --results-directory ./coverage \
  --logger &quot;trx;LogFileName=test-results.trx&quot;
</code></pre>
</li>
<li><p>Purpose: ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’åé›†</p>
</li>
</ul>
</li>
<li><p><strong>Find coverage file</strong></p>
<ul>
<li>Command: <code>find ./coverage -name &quot;coverage.cobertura.xml&quot;</code></li>
<li>Output: <code>coverage-file</code> (ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹)</li>
<li>Purpose: ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’ç‰¹å®š</li>
</ul>
</li>
<li><p><strong>Generate coverage report</strong></p>
<ul>
<li>Tool: <code>reportgenerator</code></li>
<li>Input: <code>coverage.cobertura.xml</code></li>
<li>Output: <code>./coverage/report/</code> (HTML + TextSummary)</li>
<li>Purpose: äººé–“ãŒèª­ã‚ã‚‹ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ</li>
</ul>
</li>
<li><p><strong>Upload coverage to Codacy</strong></p>
<ul>
<li>Action: <code>codacy/codacy-coverage-reporter-action@a38818475bb21847788496e9f0fddaa4e84955ba</code></li>
<li>Input: <code>coverage.cobertura.xml</code></li>
<li>Token: <code>${{ secrets.CODACY_PROJECT_TOKEN }}</code></li>
<li>Continue on error: <code>true</code> (Codacyå¤±æ•—ã§ã‚‚ãƒ†ã‚¹ãƒˆã¯ç¶šè¡Œ)</li>
<li>Purpose: ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’Codacyã«å ±å‘Š</li>
</ul>
</li>
<li><p><strong>Upload test results</strong></p>
<ul>
<li>Action: <code>actions/upload-artifact@v4</code></li>
<li>Condition: <code>always()</code></li>
<li>Files:
<ul>
<li><code>coverage/</code></li>
<li><code>**/TestResults/**/*.trx</code></li>
</ul>
</li>
<li>Retention: 7æ—¥</li>
<li>Purpose: ãƒ†ã‚¹ãƒˆçµæœã¨ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ã—ã¦ä¿å­˜</li>
</ul>
</li>
<li><p><strong>Publish test results</strong></p>
<ul>
<li>Action: <code>dorny/test-reporter@bdab7eb6dfb6be17ac3d72352f67e559a72c8db1</code> (v2)</li>
<li>Condition: <code>always()</code></li>
<li>Reporter: <code>dotnet-trx</code></li>
<li>Fail on error: <code>true</code> (ãƒ†ã‚¹ãƒˆå¤±æ•—ã§ã‚¸ãƒ§ãƒ–å¤±æ•—)</li>
<li>Purpose: PRã«ãƒ†ã‚¹ãƒˆçµæœã‚’è¡¨ç¤º</li>
</ul>
</li>
</ol>
<hr>
<h2 id="ãƒ†ã‚¹ãƒˆè¦ä»¶">ãƒ†ã‚¹ãƒˆè¦ä»¶</h2>
<h3 id="ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—">ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—</h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>Required</th>
<th>Tool</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Unit Tests</td>
<td>âœ… Yes</td>
<td>xUnit</td>
<td><code>wt.tests/</code></td>
</tr>
<tr>
<td>Integration Tests</td>
<td>âš ï¸ Recommended</td>
<td>xUnit</td>
<td><code>wt.tests/Integration/</code></td>
</tr>
<tr>
<td>Coverage Collection</td>
<td>âœ… Yes</td>
<td>coverlet</td>
<td>(è‡ªå‹•)</td>
</tr>
</tbody>
</table>
<h3 id="ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™">ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Target</th>
<th>Enforcement</th>
</tr>
</thead>
<tbody>
<tr>
<td>Line Coverage</td>
<td>80%</td>
<td>âš ï¸ Warning (not blocking)</td>
</tr>
<tr>
<td>Branch Coverage</td>
<td>70%</td>
<td>âš ï¸ Warning (not blocking)</td>
</tr>
<tr>
<td>Method Coverage</td>
<td>75%</td>
<td>âš ï¸ Warning (not blocking)</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„</strong>: ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã¯ aspirational goal ã§ã‚ã‚Šã€ãƒãƒ¼ã‚¸ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã›ã‚“ (ADR 0005å‚ç…§)ã€‚</p>
<hr>
<h2 id="å“è³ªã‚²ãƒ¼ãƒˆ-quality-gates">å“è³ªã‚²ãƒ¼ãƒˆ (Quality Gates)</h2>
<h3 id="ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°-merge-blocked">ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚° (Merge blocked)</h3>
<ol>
<li><strong>ãƒ†ã‚¹ãƒˆå¤±æ•—</strong> â†’ âŒ ãƒãƒ¼ã‚¸ãƒ–ãƒ­ãƒƒã‚¯
<ul>
<li>æ¡ä»¶: <code>dotnet test</code> ãŒ exit code 1 ã‚’è¿”ã™</li>
<li>ç†ç”±: å›å¸°é˜²æ­¢</li>
</ul>
</li>
</ol>
<h3 id="éãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°-warning-only">éãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚° (Warning only)</h3>
<ol>
<li><p><strong>ã‚«ãƒãƒ¬ãƒƒã‚¸ä½ä¸‹</strong> â†’ âš ï¸ è­¦å‘Šã®ã¿</p>
<ul>
<li>æ¡ä»¶: ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒå‰å›ã‚ˆã‚Šä½ä¸‹</li>
<li>ç†ç”±: é–‹ç™ºé€Ÿåº¦ã¨ã®ãƒãƒ©ãƒ³ã‚¹</li>
</ul>
</li>
<li><p><strong>Codacyã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—</strong> â†’ âš ï¸ è­¦å‘Šã®ã¿</p>
<ul>
<li>æ¡ä»¶: Codacy APIã‚¨ãƒ©ãƒ¼</li>
<li>ç†ç”±: å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€æ™‚çš„éšœå®³ã‚’è¨±å®¹</li>
</ul>
</li>
</ol>
<hr>
<h2 id="ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆå½¢å¼">ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆå½¢å¼</h2>
<h3 id="cobertura-xml">Cobertura XML</h3>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;coverage line-rate=&quot;0.85&quot; branch-rate=&quot;0.72&quot;&gt;
  &lt;packages&gt;
    &lt;package name=&quot;wt.cli&quot; line-rate=&quot;0.85&quot;&gt;
      &lt;classes&gt;
        &lt;class name=&quot;Program&quot; line-rate=&quot;1.0&quot;&gt;
          &lt;lines&gt;
            &lt;line number=&quot;10&quot; hits=&quot;5&quot; branch=&quot;false&quot;/&gt;
            &lt;line number=&quot;11&quot; hits=&quot;5&quot; branch=&quot;true&quot; condition-coverage=&quot;75% (3/4)&quot;/&gt;
          &lt;/lines&gt;
        &lt;/class&gt;
      &lt;/classes&gt;
    &lt;/package&gt;
  &lt;/packages&gt;
&lt;/coverage&gt;
</code></pre>
<h3 id="github-step-summary">GitHub Step Summary</h3>
<pre><code class="lang-markdown">### ğŸ“Š Coverage Summary

Summary
  Generated on: 2026-01-05 12:00:00
  Line coverage: 85.2%
  Branch coverage: 72.1%
  Method coverage: 78.5%
  
  Assemblies: 2
  Classes: 25
  Files: 30
  Covered lines: 1234
  Uncovered lines: 215
  Coverable lines: 1449
</code></pre>
<hr>
<h2 id="codacyé€£æº">Codacyé€£æº</h2>
<h3 id="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š</h3>
<ul>
<li><strong>Organization</strong>: <code>kuju63</code></li>
<li><strong>Repository</strong>: <code>wt</code></li>
<li><strong>Token</strong>: <code>${{ secrets.CODACY_PROJECT_TOKEN }}</code></li>
</ul>
<h3 id="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</h3>
<ul>
<li><strong>Format</strong>: Cobertura XML</li>
<li><strong>Language</strong>: C#</li>
<li><strong>Coverage Tool</strong>: coverlet (via <code>dotnet test --collect</code>)</li>
</ul>
<h3 id="codacyã‚³ãƒ¡ãƒ³ãƒˆä¾‹-pr">Codacyã‚³ãƒ¡ãƒ³ãƒˆä¾‹ (PR)</h3>
<pre><code class="lang-markdown">## Codacy Coverage Report

Coverage: 85.2% (+2.5%)

Changes by file:
- wt.cli/Program.cs: 95% (+5%)
- wt.cli/Services/GitService.cs: 80% (-3%)

Overall: âœ… Coverage increased
</code></pre>
<hr>
<h2 id="ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°">ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</h2>
<h3 id="ãƒ†ã‚¹ãƒˆå¤±æ•—">ãƒ†ã‚¹ãƒˆå¤±æ•—</h3>
<pre><code class="lang-text">Error: Test failed with exit code 1
  
  Failed tests:
    - wt.tests.GitServiceTests.CreateWorktree_ShouldReturnSuccess
    - wt.tests.EditorServiceTests.OpenEditor_ShouldLaunchVSCode
</code></pre>
<p><strong>å‹•ä½œ</strong>: ã‚¸ãƒ§ãƒ–å¤±æ•—ã€PRãƒãƒ¼ã‚¸ãƒ–ãƒ­ãƒƒã‚¯</p>
<h3 id="ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«æœªæ¤œå‡º">ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«æœªæ¤œå‡º</h3>
<pre><code class="lang-text">Warning: Coverage file not found
</code></pre>
<p><strong>å‹•ä½œ</strong>: ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¹ã‚­ãƒƒãƒ—ã€ãƒ†ã‚¹ãƒˆã¯ç¶šè¡Œ</p>
<h3 id="codacyã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—">Codacyã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—</h3>
<pre><code class="lang-text">Warning: Failed to upload coverage to Codacy
Error: Project token is invalid
</code></pre>
<p><strong>å‹•ä½œ</strong>: è­¦å‘Šãƒ­ã‚°ã€ãƒ†ã‚¹ãƒˆã¯ç¶šè¡Œ (continue-on-error: true)</p>
<hr>
<h2 id="æ€§èƒ½è¦ä»¶">æ€§èƒ½è¦ä»¶</h2>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Target</th>
<th>Acceptable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Test execution time</td>
<td>&lt; 5åˆ†</td>
<td>&lt; 10åˆ†</td>
</tr>
<tr>
<td>Coverage collection overhead</td>
<td>&lt; 20%</td>
<td>&lt; 30%</td>
</tr>
<tr>
<td>Total workflow time</td>
<td>&lt; 8åˆ†</td>
<td>&lt; 15åˆ†</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="æ¨©é™">æ¨©é™</h2>
<pre><code class="lang-yaml">permissions:
  contents: read        # ãƒªãƒã‚¸ãƒˆãƒªã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Š
  checks: write         # ãƒ†ã‚¹ãƒˆçµæœã®æ›¸ãè¾¼ã¿
  pull-requests: write  # PRã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆ
</code></pre>
<hr>
<h2 id="ãƒ–ãƒ©ãƒ³ãƒãƒ—ãƒ­ãƒ†ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š">ãƒ–ãƒ©ãƒ³ãƒãƒ—ãƒ­ãƒ†ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š</h2>
<h3 id="required-status-checks">Required Status Checks</h3>
<pre><code class="lang-yaml"># GitHub Settings â†’ Branches â†’ main â†’ Branch protection rules
protection:
  required_status_checks:
    strict: true
    checks:
      - &quot;Test and Coverage / Run Tests&quot;  # âœ… Required
</code></pre>
<p><strong>å‹•ä½œ</strong>:</p>
<ul>
<li>âœ… ãƒ†ã‚¹ãƒˆæˆåŠŸ â†’ PRãƒãƒ¼ã‚¸å¯èƒ½</li>
<li>âŒ ãƒ†ã‚¹ãƒˆå¤±æ•— â†’ PRãƒãƒ¼ã‚¸ãƒ–ãƒ­ãƒƒã‚¯</li>
<li>âš ï¸ Codacyã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•— â†’ PRãƒãƒ¼ã‚¸å¯èƒ½ (éãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°)</li>
</ul>
<hr>
<h2 id="ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†</h2>
<h3 id="ãƒ†ã‚¹ãƒˆãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£">ãƒ†ã‚¹ãƒˆãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£</h3>
<pre><code class="lang-csharp">// wt.tests/Fixtures/GitFixture.cs
public class GitFixture : IDisposable
{
    public string TempRepoPath { get; }
    
    public GitFixture()
    {
        TempRepoPath = Path.Combine(Path.GetTempPath(), Guid.NewGuid().ToString());
        Directory.CreateDirectory(TempRepoPath);
        // Initialize git repo
    }
    
    public void Dispose()
    {
        if (Directory.Exists(TempRepoPath))
        {
            Directory.Delete(TempRepoPath, recursive: true);
        }
    }
}
</code></pre>
<h3 id="ãƒ¢ãƒƒã‚¯">ãƒ¢ãƒƒã‚¯</h3>
<pre><code class="lang-csharp">// wt.tests/Mocks/MockProcessRunner.cs
public class MockProcessRunner : IProcessRunner
{
    public ProcessResult Run(string command, string args)
    {
        return new ProcessResult
        {
            ExitCode = 0,
            Output = &quot;mocked output&quot;,
            Error = string.Empty
        };
    }
}
</code></pre>
<hr>
<h2 id="ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</h2>
<h3 id="ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ">ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</h3>
<pre><code class="lang-bash">dotnet test wt.sln --configuration Release --verbosity normal
</code></pre>
<h3 id="ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãã§å®Ÿè¡Œ">ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãã§å®Ÿè¡Œ</h3>
<pre><code class="lang-bash">dotnet test wt.sln \
  --configuration Release \
  --collect:&quot;XPlat Code Coverage&quot; \
  --results-directory ./coverage
</code></pre>
<h3 id="ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ">ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ</h3>
<pre><code class="lang-bash">dotnet tool install --global dotnet-reportgenerator-globaltool

reportgenerator \
  -reports:&quot;./coverage/**/coverage.cobertura.xml&quot; \
  -targetdir:&quot;./coverage/report&quot; \
  -reporttypes:&quot;Html;TextSummary&quot;

# HTMLãƒ¬ãƒãƒ¼ãƒˆã‚’é–‹ã
open ./coverage/report/index.html
</code></pre>
<h3 id="ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ">ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</h3>
<pre><code class="lang-bash">dotnet test wt.tests/GitServiceTests.cs --filter &quot;CreateWorktree&quot;
</code></pre>
<hr>
<h2 id="ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°">ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
<h3 id="å•é¡Œ-ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹">å•é¡Œ: ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹</h3>
<p><strong>è§£æ±º</strong>:</p>
<ol>
<li><p>ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ:</p>
<pre><code class="lang-bash">dotnet test wt.sln --verbosity detailed
</code></pre>
</li>
<li><p>å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆã®ãƒ­ã‚°ã‚’ç¢ºèª:</p>
<pre><code class="lang-bash">cat TestResults/test-results.trx
</code></pre>
</li>
<li><p>ãƒ†ã‚¹ãƒˆã‚’ä¿®æ­£ã—ã¦ãƒ—ãƒƒã‚·ãƒ¥</p>
</li>
</ol>
<h3 id="å•é¡Œ-ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒ0">å•é¡Œ: ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒ0%</h3>
<p><strong>è§£æ±º</strong>:</p>
<ol>
<li><p>ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª:</p>
<pre><code class="lang-bash">find ./coverage -name &quot;coverage.cobertura.xml&quot;
cat ./coverage/**/coverage.cobertura.xml
</code></pre>
</li>
<li><p>ã‚«ãƒãƒ¬ãƒƒã‚¸åé›†ã®è¨­å®šã‚’ç¢ºèª:</p>
<pre><code class="lang-bash">dotnet test --collect:&quot;XPlat Code Coverage&quot;
</code></pre>
</li>
</ol>
<h3 id="å•é¡Œ-codacyã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—">å•é¡Œ: Codacyã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—</h3>
<p><strong>è§£æ±º</strong>:</p>
<ol>
<li><p>Codacyãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç¢ºèª:</p>
<pre><code class="lang-bash">gh secret list | grep CODACY
</code></pre>
</li>
<li><p>ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å†è¨­å®š:</p>
<pre><code class="lang-bash">gh secret set CODACY_PROJECT_TOKEN
</code></pre>
</li>
</ol>
<hr>
<h2 id="ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹">ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹</h2>
<ul>
<li>ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«: <a href="../../../.github/workflows/test.yml">.github/workflows/test.yml</a></li>
<li>ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: <a href="../../../wt.tests/">wt.tests/</a></li>
<li>ADR 0005: <a href="../../../docs/adr/0005-quality-gates-testing-requirements.html">å“è³ªã‚²ãƒ¼ãƒˆ</a></li>
<li>ã‚¿ã‚¹ã‚¯: <a href="../tasks.html#user-story-4-verify-all-changes-are-tested-with-coverage">tasks.md</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/kuju63/wt/blob/main/specs/003-automated-release-pipeline/contracts/test-workflow.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
